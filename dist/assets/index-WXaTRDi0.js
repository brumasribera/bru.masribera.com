var x=(l,y,m)=>new Promise((g,b)=>{var h=i=>{try{s(m.next(i))}catch(u){b(u)}},f=i=>{try{s(m.throw(i))}catch(u){b(u)}},s=i=>i.done?g(i.value):Promise.resolve(i.value).then(h,f);s((m=m.apply(l,y)).next())});import{r as o,j as c}from"./index-CgGUfUU8.js";const k={start:"/timer-sounds/start-gong.mp3",middle:"/timer-sounds/middle-gong.mp3",minute:"/timer-sounds/1m-gong.mp3",end:"/timer-sounds/end-gong.mp3"};function L(){const[l,y]=o.useState(480),[m,g]=o.useState(!1),[b,h]=o.useState(!1),f=o.useRef(null),s=o.useRef({});o.useEffect(()=>(document.title="Timer",(()=>{const t=document.querySelector("link[rel='manifest']");t&&(t.dataset.originalHref||(t.dataset.originalHref=t.href),t.href="/tools/timer/manifest.webmanifest",console.log("Timer manifest set to:",t.href),console.log("Current path:",window.location.pathname))})(),(()=>{[{name:"mobile-web-app-capable",content:"yes"},{name:"apple-mobile-web-app-capable",content:"yes"},{name:"apple-mobile-web-app-status-bar-style",content:"default"},{name:"apple-mobile-web-app-title",content:"Timer"},{name:"application-name",content:"Timer"}].forEach(n=>{if(!document.querySelector(`meta[name="${n.name}"]`)){const d=document.createElement("meta");d.name=n.name,d.content=n.content,document.head.appendChild(d)}})})(),()=>{const t=document.querySelector("link[rel='manifest']");t&&t.dataset.originalHref&&(t.href=t.dataset.originalHref,delete t.dataset.originalHref),["mobile-web-app-capable","apple-mobile-web-app-capable","apple-mobile-web-app-status-bar-style","apple-mobile-web-app-title","application-name"].forEach(r=>{const d=document.querySelector(`meta[name="${r}"]`);d&&d.remove()})}),[]),o.useEffect(()=>{(()=>{const n=document.querySelector("link[rel*='icon']");if(n)n.href="/favicons/favicon-timer.svg";else{const r=document.createElement("link");r.type="image/svg+xml",r.rel="icon",r.href="/favicons/favicon-timer.svg",document.head.appendChild(r)}})();let e=!0;return x(this,null,function*(){for(const[n,r]of Object.entries(k)){if(!e)break;try{if(!(yield fetch(r)).ok)continue;if(!e)break;const p=new Audio(r);p.preload="auto",p.volume=1,s.current[n]=p,p.addEventListener("error",()=>{}),p.addEventListener("canplaythrough",()=>{}),p.addEventListener("pause",()=>{}),p.addEventListener("play",()=>{})}catch(d){}}}),()=>{e=!1;const n=document.querySelector("link[rel*='icon']");n&&n.href.includes("favicon-timer")&&(n.href="/favicon.ico"),Object.values(s.current).forEach(r=>{r.pause(),r.src=""}),s.current={}}},[]);const i=o.useCallback(()=>{!s.current||Object.keys(s.current).length===0||Object.entries(s.current).forEach(([a,e])=>{e.paused&&e.currentTime>0&&e.currentTime<e.duration&&e.play().catch(()=>{})})},[]);o.useEffect(()=>{const a=()=>{i()},e=()=>{document.hidden||i()};return window.addEventListener("focus",a),document.addEventListener("visibilitychange",e),()=>{window.removeEventListener("focus",a),document.removeEventListener("visibilitychange",e)}},[i]);const u=a=>{const e=s.current[a];if(e)try{e.currentTime=0,e.volume=1;const t=e.play();t!==void 0&&t.catch(n=>{})}catch(t){}};o.useEffect(()=>(m&&l>0?f.current=setInterval(()=>{y(a=>{const e=a-1;return e>0&&e%60===0&&u("minute"),e===4*60&&u("middle"),e})},1e3):l===0&&!b&&(h(!0),g(!1),u("end")),()=>{f.current&&clearInterval(f.current)}),[m,l,b]);const w=()=>{l!==0&&(g(!0),h(!1),l===8*60&&u("start"))},v=()=>{g(!1),f.current&&clearInterval(f.current)},T=()=>{v(),y(8*60),h(!1),g(!1)},j=a=>{const e=Math.floor(a/60),t=a%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`};return c.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center p-4",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-8xl font-light text-gray-300 mb-8 font-mono tracking-wider",children:j(l)}),c.jsxs("div",{className:"flex gap-6 justify-center",children:[!m&&l>0&&!b&&c.jsx("button",{onClick:w,className:"w-16 h-16 bg-gray-700 text-gray-200 rounded-full font-medium hover:bg-gray-600 transition-all duration-200 flex items-center justify-center",title:"Start",children:c.jsx("div",{className:"w-0 h-0 border-l-[16px] border-l-gray-200 border-t-[10px] border-t-transparent border-b-[10px] border-b-transparent ml-1"})}),m&&c.jsxs("button",{onClick:v,className:"w-16 h-16 bg-gray-700 text-gray-200 rounded-full font-medium hover:bg-gray-600 transition-all duration-200 flex items-center justify-center gap-1",title:"Pause",children:[c.jsx("div",{className:"w-1.5 h-6 bg-gray-200 rounded-sm"}),c.jsx("div",{className:"w-1.5 h-6 bg-gray-200 rounded-sm"})]}),c.jsx("button",{onClick:T,className:"w-16 h-16 bg-gray-800 text-gray-200 rounded-full font-medium hover:bg-gray-700 transition-all duration-200 flex items-center justify-center text-3xl",title:"Reset",children:"â†º"})]})]})})}export{L as TimerPage};
